<!doctype html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" />
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <link rel="stylesheet" href="/main.css" />

    <title>Filestack</title>
</head>
<body>
<div th:fragment="filestack-pic">

    <!--<div class="container">-->
        <!--<h1 class="text-center">upload a profile picture</h1>-->
        <!--<form th:action="@{/newuser/newchefprofile}" th:method="post" th:object="${chef}">-->
            <!--<button id="picture" type="button" th:value="*{picture}">Insert a profile picture</button>-->
        <!--</form>-->
    <!--</div>-->

<!--<div th:field="*{picture}"></div>-->

    <div class="control-group">
        <div class="controls">
            <button id="picture" type="button" class="btn btn-primary">Upload Image</button>
        </div>
    </div>
    <div id="profile-pic"></div>
    <div id="picUrl"></div>



    <!--<div class="control-group">-->
        <!--<div class="controls">-->
            <!--<button id="video" type="button" class="btn btn-link btn-secondary">Upload Video</button>-->
        <!--</div>-->
    <!--</div>-->
    <!--<div id="profile-video"></div>-->
    <!--<div id="videoUrl"></div>-->



<script src="https://static.filestackapi.com/v3/filestack.js"></script>
<script type="text/javascript">

    //=====================IMAGE API CALL=====================//

    var fsClient = filestack.init('ATnrBVr9hSauBEG4HxXF3z');
    function openImagePicker() {
        fsClient.pick({
            fromSources:["local_file_system", "url", "imagesearch", "facebook", "instagram", "dropbox"],
            accept:["image/*"],
            maxFiles:1,
            maxSize:10485760,
            transformations:{circle:true}
        }).then(function (response) {
            // declare this function to handle response
            handleImageFilestack(response);
        });
    }

    //this function handles the response from filestack and uploads the picture to the page
    function handleImageFilestack(response){
        console.log(response);
        document.getElementById('profile-pic').innerHTML = '<img id="upload" name="upload" src=" ' +response.filesUploaded['0'].url +  '" />';
        document.getElementById('picUrl').innerHTML = '<input  class="hideUrl" type="text" id="upload" name="upload" value=" ' +response.filesUploaded['0'].url +  '"/>';
        document.getElementById('upload').dataset.handler = response.url;
    }


    //open ImagePicker button
    var picture = document.getElementById('picture');
    function pictureButton () {
        picture.addEventListener('click', function () {
            openImagePicker();
        });
    } pictureButton();




</script>
</div>


<div th:fragment="filestack-video">


</div>
</body>
</html>